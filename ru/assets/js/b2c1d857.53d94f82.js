(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[242],{2268:function(t,e,n){"use strict";n.d(e,{Z:function(){return s}});var o=n(2122),i=n(9756),l=n(7294),a=n(1756),r=["children","language"];function s(t){var e=t.children,n=t.language,s=(0,i.Z)(t,r);return l.createElement(a.Z,(0,o.Z)({className:n||"language-csharp"},s),e.replace(/\t/g,"    "))}},7052:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var o=n(9756),i=n(7294),l=["color","size"];function a(t){var e=t.color,n=t.size;(0,o.Z)(t,l);return n=(n||14)+"px",i.createElement("div",{style:{display:"inline"}},i.createElement("div",{style:{display:"inline-block",width:n,height:n,background:e,marginRight:"2px"}}),i.createElement("div",{style:{display:"inline"}},e))}},3328:function(t,e,n){"use strict";n.d(e,{Z:function(){return p}});var o=n(9756),i=n(7294),l=n(4996),a="container_373Z",r="slot_32Ts",s="sprite_ipAF",m="tooltip_2_kr",u="count_39FS",c=["sprite","tooltip","tooltipColor","count","countColor"];function p(t){var e=t.sprite,n=t.tooltip,p=t.tooltipColor,d=t.count,b=t.countColor;(0,o.Z)(t,c);return i.createElement("div",{className:a},i.createElement("img",{key:"slot",className:r,src:(0,l.Z)("/img/SetupDetailsGenerator/ToolbarSlot.png")}),null==e?[]:i.createElement("img",{key:"sprite",className:s,src:e}),null==n?[]:i.createElement("span",{key:"tooltip",className:m},i.createElement("span",{style:{color:p||"#FFED00"}},n)),null==d?[]:i.createElement("span",{key:"count",className:u},i.createElement("span",{style:{color:b||"#FFFFFF"}},d)))}},9309:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});var o=n(2122),i=n(9756),l=n(7294),a=["children"];function r(t){var e=t.children,n=(0,i.Z)(t,a);return l.createElement("div",(0,o.Z)({role:"tabpanel"},n),e)}},8952:function(t,e,n){"use strict";n.d(e,{Z:function(){return p}});var o=n(7294),i=n(9443);var l=function(){var t=(0,o.useContext)(i.Z);if(null==t)throw new Error('"useUserPreferencesContext" is used outside of "Layout" component.');return t},a=n(6010),r="tabItem_2O3c",s="tabItemActive_Fpbe",m="tab_1pgU";var u=37,c=39;var p=function(t){var e=t.lazy,n=t.block,i=t.defaultValue,p=t.values,d=t.groupId,b=t.className,h=l(),f=h.tabGroupChoices,C=h.setTabGroupChoices,g=(0,o.useState)(i),v=g[0],k=g[1],y=o.Children.toArray(t.children),I=[];if(null!=d){var w=f[d];null!=w&&w!==v&&p.some((function(t){return t.value===w}))&&k(w)}var x=function(t){var e=t.currentTarget,n=I.indexOf(e),o=p[n].value;k(o),null!=d&&(C(d,o),setTimeout((function(){var t,n,o,i,l,a,r,m;(t=e.getBoundingClientRect(),n=t.top,o=t.left,i=t.bottom,l=t.right,a=window,r=a.innerHeight,m=a.innerWidth,n>=0&&l<=m&&i<=r&&o>=0)||(e.scrollIntoView({block:"center",behavior:"smooth"}),e.classList.add(s),setTimeout((function(){return e.classList.remove(s)}),2e3))}),150))},T=function(t){var e,n;switch(t.keyCode){case c:var o=I.indexOf(t.target)+1;n=I[o]||I[0];break;case u:var i=I.indexOf(t.target)-1;n=I[i]||I[I.length-1]}null==(e=n)||e.focus()},N=function(t,e){return e.value===t||e.values&&-1!=e.values.indexOf(t)};return o.createElement("div",{className:"tabs-container"},o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.Z)("tabs",{"tabs--block":n},b)},p.map((function(t){var e=t.value,n=t.label;return o.createElement("li",{role:"tab",tabIndex:v===e?0:-1,"aria-selected":v===e,className:(0,a.Z)("tabs__item",r,{"tabs__item--active":v===e}),key:e,ref:function(t){return I.push(t)},onKeyDown:T,onFocus:x,onClick:x},n)}))),e?(0,o.cloneElement)(y.filter((function(t){return N(v,t.props)}))[0],{className:m}):o.createElement("div",null,y.map((function(t,e){return(0,o.cloneElement)(t,{key:e,hidden:!N(v,t.props),className:m})}))),o.createElement("br",null))}},6735:function(t,e,n){"use strict";n.r(e),n.d(e,{PreviewTooltip:function(){return C},contentTitle:function(){return h},default:function(){return k},frontMatter:function(){return b},metadata:function(){return f},toc:function(){return g}});var o=n(2122),i=n(9756),l=n(7294),a=n(3905),r=n(8952),s=n(9309),m=n(4996),u=n(7052),c=n(3328),p=n(2268),d=["components"],b={},h="Combinable Items",f={unversionedId:"items/combinable-items",id:"items/combinable-items",isDocsHomePage:!1,title:"Combinable Items",description:"Making items combinable",source:"@site/docs/items/combinable-items.mdx",sourceDirName:"items",slug:"/items/combinable-items",permalink:"/RogueLibs/ru/docs/items/combinable-items",editUrl:"https://github.com/Abbysssal/RogueLibs/edit/master/website/docs/items/combinable-items.mdx",version:"current",frontMatter:{},sidebar:"documentationSidebar",previous:{title:"Usable Items",permalink:"/RogueLibs/ru/docs/items/usable-items"},next:{title:"Targetable Items",permalink:"/RogueLibs/ru/docs/items/targetable-items"}};function C(t){t.props;var e=(0,l.useState)((0,m.Z)("/img/SetupDetailsGenerator/TestItem.png")),n=e[0],o=e[1],i=(0,l.useState)("#FFED00"),r=i[0],s=i[1],u=(0,l.useState)("$123"),p=u[0],d=u[1];return(0,a.kt)("div",{style:{padding:"10px",border:"5px dashed var(--ifm-menu-color-background-hover)",width:"max-content"}},(0,a.kt)("input",{type:"file",accept:"image/*",onChange:function(t){if(t.target.files[0]){var e=new FileReader;e.addEventListener("load",(function(){return o(e.result)})),e.readAsDataURL(t.target.files[0])}},style:{margin:"5px"}}),(0,a.kt)("div",{style:{margin:"5px"}},(0,a.kt)(c.Z,{sprite:n,tooltip:p,tooltipColor:r,mdxType:"InventorySlot"})),(0,a.kt)("input",{type:"text",placeholder:"$123",onChange:function(t){return d(t.target.value)},style:{fontSize:"22px",margin:"5px"}}),(0,a.kt)("input",{type:"color",value:r,onChange:function(t){return s(t.target.value)}}))}var g=[{value:"Making items combinable",id:"making-combinable",children:[{value:"Inventory Slot Preview",id:"slot-preview",children:[]}]},{value:"Examples",id:"examples",children:[]}],v={PreviewTooltip:C,toc:g};function k(t){var e=t.components,n=(0,i.Z)(t,d);return(0,a.kt)("wrapper",(0,o.Z)({},v,n,{components:e,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"combinable-items"},"Combinable Items"),(0,a.kt)("h2",{id:"making-combinable"},"Making items combinable"),(0,a.kt)("p",null,"Just implement the ",(0,a.kt)("inlineCode",{parentName:"p"},"IItemCombinable")," interface in your item's class:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csharp",metastring:'title="MyCombinableItem.cs"',title:'"MyCombinableItem.cs"'},"// highlight-next-line\npublic class MyCombinableItem : CustomItem, IItemCombinable\n{\n    // highlight-start\n    public bool CombineFilter(InvItem other) { /* ... */ }\n    public bool CombineItems(InvItem other) { /* ... */ }\n    public CustomTooltip CombineTooltip(InvItem other) { /* ... */ }\n    public CustomTooltip CombineCursorText(InvItem other) { /* ... */ }\n    // highlight-end\n}\n")),(0,a.kt)("p",null,"Plus, your item's type must be ",(0,a.kt)("inlineCode",{parentName:"p"},'"Combine"'),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csharp"},"    public override void SetupDetails()\n    {\n        // highlight-next-line\n        Item.itemType = ItemTypes.Combine;\n        /* ... */\n    }\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"CombineFilter")," determines what items will be highlighted, when combining the current item."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"CombineItems")," combines the current item with the other one. The return value indicates whether it was a success or not. Usually you'd just play a ",(0,a.kt)("inlineCode",{parentName:"p"},'"CantDo"')," sound, if the items cannot be combined. Returning ",(0,a.kt)("inlineCode",{parentName:"p"},"true")," will also play an animation."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"CombineTooltip")," determines the tooltip in the upper-left corner of the inventory slot. Text set to ",(0,a.kt)("inlineCode",{parentName:"p"},"null")," will default to an empty string, and Color set to ",(0,a.kt)("inlineCode",{parentName:"p"},"null")," will default to ",(0,a.kt)(u.Z,{color:"#FFED00",mdxType:"ColorSquare"}),". ",(0,a.kt)("a",{parentName:"p",href:"#slot-preview"},"See the tool below"),"."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"CombineCursorText")," determines the cursor text when hovering over the item. You can also specify the cursor text's color. Text set to ",(0,a.kt)("inlineCode",{parentName:"p"},"null"),' will default to "Combine", and Color set to ',(0,a.kt)("inlineCode",{parentName:"p"},"null")," will default to ",(0,a.kt)(u.Z,{color:"#FFFFFF",mdxType:"ColorSquare"}),"."),(0,a.kt)("h3",{id:"slot-preview"},"Inventory Slot Preview"),(0,a.kt)("p",null,"Wanna see how your ",(0,a.kt)("inlineCode",{parentName:"p"},"CombineTooltip")," will look in the game? Check out this small tool:"),(0,a.kt)(C,{mdxType:"PreviewTooltip"}),(0,a.kt)("h2",{id:"examples"},"Examples"),(0,a.kt)(r.Z,{defaultValue:"ammobox",values:[{label:"Ammo Box",value:"ammobox"}],mdxType:"Tabs"},(0,a.kt)(s.Z,{value:"ammobox",mdxType:"TabItem"},(0,a.kt)("p",null,"A pretty complicated example with a lot of math."),(0,a.kt)(p.Z,{mdxType:"CodeSnippet"},'using UnityEngine;\n\nnamespace RogueLibsCore.Test\n{\n\t[ItemCategories(RogueCategories.Technology, RogueCategories.GunAccessory, RogueCategories.Guns)]\n\tpublic class AmmoBox : CustomItem, IItemCombinable\n\t{\n\t\t[RLSetup]\n\t\tpublic static void Setup()\n\t\t{\n\t\t\tRogueLibs.CreateCustomItem<AmmoBox>()\n\t\t\t\t.WithName(new CustomNameInfo("Ammo Box"))\n\t\t\t\t.WithDescription(new CustomNameInfo("Combine with any refillable weapon to refill it. Limited ammo."))\n\t\t\t\t.WithSprite(Properties.Resources.AmmoBox)\n\t\t\t\t.WithUnlock(new ItemUnlock\n\t\t\t\t{\n\t\t\t\t\tUnlockCost = 10,\n\t\t\t\t\tCharacterCreationCost = 3,\n\t\t\t\t\tLoadoutCost = 3,\n\t\t\t\t\tPrerequisites = { "AmmoProcessor", "KillProfiterAmmo", "AmmoCapacityMod" },\n\t\t\t\t});\n\t\t}\n\n\t\tpublic override void SetupDetails()\n\t\t{\n\t\t\tItem.itemType = ItemTypes.Combine;\n\t\t\tItem.itemValue = 4;\n\t\t\tItem.initCount = 100;\n\t\t\tItem.rewardCount = 200;\n\t\t\tItem.hasCharges = true;\n\t\t\tItem.stackable = true;\n\t\t}\n\t\tpublic bool CombineFilter(InvItem other) => other.itemType == ItemTypes.WeaponProjectile && !other.noRefills;\n\t\tpublic bool CombineItems(InvItem other)\n\t\t{\n\t\t\tif (!CombineFilter(other))\n\t\t\t{\n\t\t\t\tgc.audioHandler.Play(Owner, "CantDo");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (other.invItemCount >= other.maxAmmo)\n\t\t\t{\n\t\t\t\tOwner.SayDialogue("AmmoDispenserFull");\n\t\t\t\tgc.audioHandler.Play(Owner, "CantDo");\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tint amountToRefill = other.maxAmmo - other.invItemCount;\n\t\t\tfloat singleCost = (float)other.itemValue / other.maxAmmo;\n\t\t\tif (Owner.oma.superSpecialAbility && (Owner.agentName == "Soldier" || Owner.agentName == "Doctor"))\n\t\t\t\tsingleCost = 0f;\n\n\t\t\tint affordableAmount = (int)Mathf.Ceil(Count / singleCost);\n\t\t\tint willBeBought = Mathf.Min(affordableAmount, amountToRefill);\n\t\t\tint willBeReduced = (int)Mathf.Min(Count, willBeBought * singleCost);\n\n\t\t\tCount -= willBeReduced;\n\t\t\tother.invItemCount += willBeBought;\n\t\t\tOwner.SayDialogue("AmmoDispenserFilled");\n\t\t\tgc.audioHandler.Play(Owner, "BuyItem");\n\t\t\treturn true;\n\t\t}\n\n\t\tpublic CustomTooltip CombineTooltip(InvItem other)\n\t\t{\n\t\t\tif (!CombineFilter(other)) return default;\n\n\t\t\tint amountToRefill = other.maxAmmo - other.invItemCount;\n\t\t\tif (amountToRefill == 0) return default;\n\n\t\t\tfloat singleCost = (float)other.itemValue / other.maxAmmo;\n\t\t\tif (Owner.oma.superSpecialAbility && (Owner.agentName == "Soldier" || Owner.agentName == "Doctor"))\n\t\t\t\tsingleCost = 0f;\n\t\t\tint cost = (int)Mathf.Floor(amountToRefill * singleCost);\n\t\t\tint canAfford = (int)Mathf.Ceil(Count / singleCost);\n\n\t\t\treturn "+" + Mathf.Min(amountToRefill, canAfford) + " (" + Mathf.Min(cost, Count) + ")";\n\t\t}\n\n\t\tpublic CustomTooltip CombineCursorText(InvItem other) => gc.nameDB.GetName("RefillGun", "Interface");\n\t\t// it\'s one of the vanilla dialogues, so there\'s no need to define it in the mod\n\t}\n}\n'))))}k.isMDXComponent=!0}}]);