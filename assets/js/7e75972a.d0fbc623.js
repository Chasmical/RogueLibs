"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[8893],{4214:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(7294),i=n(614);function a(e){let{children:t,language:n}=e;return o.createElement(i.Z,{className:"language-"+(n||"csharp")},t.replace(/\t/g,"    "))}},2725:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(7294);function i(e){let{color:t,size:n}=e,i=(n||14)+"px";return o.createElement("div",{style:{display:"inline"}},o.createElement("div",{style:{display:"inline-block",width:i,height:i,background:t,marginRight:"2px"}}),o.createElement("div",{style:{display:"inline"}},t))}},5880:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(7294),i=n(6010);const a={container:"container_ek75",cursorLocked:"cursorLocked_H61i",normal:"normal_n5ah",hoverable:"hoverable_F5EM",selected:"selected_mneN",locked:"locked_H8Qp",sprite:"sprite_ZRUo",tooltip:"tooltip_QxcU",count:"count_Z8Fk"};function l(e){let{sprite:t,tooltip:n,tooltipColor:l,count:r,countColor:s,hoverable:u,cantClick:m,type:c="normal",onClick:p}=e;return o.createElement("div",{onClick:p,className:(0,i.Z)(a.container,m&&a.cursorLocked,c&&a[c],u&&a.hoverable)},t&&o.createElement("img",{key:"sprite",className:a.sprite,src:t}),n&&o.createElement("span",{key:"tooltip",className:a.tooltip,style:{color:l||"#FFED00"}},n),r&&o.createElement("span",{key:"count",className:a.count,style:{color:s||"#FFFFFF"}},r))}},1016:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(7462),i=n(7294);function a(e){let{children:t,...n}=e;return i.createElement("div",(0,o.Z)({role:"tabpanel"},n),t)}},5878:(e,t,n)=>{n.d(t,{Z:()=>C});var o=n(7294),i=n(6550),a=n(1980),l=n(7392),r=n(12);function s(e){return function(e){return o.Children.map(e,(e=>{if(!e||(0,o.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:n,attributes:o,default:i}}=e;return{value:t,label:n,attributes:o,default:i}}))}function u(e){const{values:t,children:n}=e;return(0,o.useMemo)((()=>{const e=t??s(n);return function(e){const t=(0,l.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function m(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function c(e){let{queryString:t=!1,groupId:n}=e;const l=(0,i.k6)(),r=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,a._X)(r),(0,o.useCallback)((e=>{if(!r)return;const t=new URLSearchParams(l.location.search);t.set(r,e),l.replace({...l.location,search:t.toString()})}),[r,l])]}function p(e){const{defaultValue:t,queryString:n=!1,groupId:i}=e,a=u(e),[l,s]=(0,o.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const o=n.find((e=>e.default))??n[0];if(!o)throw new Error("Unexpected error: 0 tabValues");return o.value}({defaultValue:t,tabValues:a}))),[p,d]=c({queryString:n,groupId:i}),[h,b]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[i,a]=(0,r.Nk)(n);return[i,(0,o.useCallback)((e=>{n&&a.set(e)}),[n,a])]}({groupId:i}),C=(()=>{const e=p??h;return m({value:e,tabValues:a})?e:null})();(0,o.useLayoutEffect)((()=>{C&&s(C)}),[C]);return{selectedValue:l,selectValue:(0,o.useCallback)((e=>{if(!m({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);s(e),d(e),b(e)}),[d,b,a]),tabValues:a}}var d=n(6010);const h={tabItem:"tabItem_V91s",tabItemActive:"tabItemActive_JsUu",blink:"blink_ZPVS",tab:"tab_ntnM"};const b={left:37,right:39};function C(e){const{lazy:t,defaultValue:n,values:i,groupId:a}=e,l=o.Children.toArray(e.children),{tabValues:r,selectedValue:s,selectValue:u}=p({children:l,defaultValue:n,values:i,groupId:a}),m=[],c=e=>{const t=e.currentTarget,n=i[m.indexOf(t)].value;u(n),null!=a&&setTimeout((()=>{(function(e){const{top:t,left:n,bottom:o,right:i}=e.getBoundingClientRect(),{innerHeight:a,innerWidth:l}=window;return t>=0&&i<=l&&o<=a&&n>=0})(t)||(t.scrollIntoView({block:"center",behavior:"smooth"}),t.classList.add(h.tabItemActive),setTimeout((()=>t.classList.remove(h.tabItemActive)),2e3))}),150)},C=e=>{let t;switch(e.keyCode){case b.right:{const n=m.indexOf(e.target)+1;t=m[n]||m[0];break}case b.left:{const n=m.indexOf(e.target)-1;t=m[n]||m[m.length-1];break}default:return}t.focus()},f=(e,t)=>t.value===e||t.values&&-1!=t.values.indexOf(e);return o.createElement("div",{className:"tabs-container"},o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:"tabs"},i.map((e=>{let{value:t,label:n}=e;return o.createElement("li",{role:"tab",tabIndex:s===t?0:-1,"aria-selected":s===t,className:(0,d.Z)("tabs__item",h.tabItem,{"tabs__item--active":s===t}),key:t,ref:e=>e&&m.push(e),onKeyDown:C,onFocus:c,onClick:c},n)}))),t?o.cloneElement(l.find((e=>f(s,e.props))),{className:h.tab}):o.createElement("div",null,l.map(((e,t)=>o.cloneElement(e,{key:t,hidden:!f(s,e.props),className:h.tab})))),o.createElement("br",null))}},7488:(e,t,n)=>{n.r(t),n.d(t,{PreviewTooltip:()=>v,assets:()=>g,contentTitle:()=>C,default:()=>w,frontMatter:()=>b,metadata:()=>f,toc:()=>I});var o=n(7462),i=n(7294),a=n(3905),l=n(5878),r=n(1016),s=n(4996),u=n(2725),m=n(5880),c=n(4214);const p='using System.Collections.Generic;\nusing System.Linq;\n\nnamespace RogueLibsCore.Test\n{\n    public class Centrifuge : CustomItem, IItemCombinable\n    {\n        [RLSetup]\n        public static void Setup()\n        {\n            /*\n            RogueLibs.CreateCustomItem<Centrifuge>()\n                .WithName(new CustomNameInfo("Centrifuge"))\n                .WithDescription(new CustomNameInfo("Combine with a syringe to invert its effect."))\n                .WithSprite(Properties.Resources.Centrifuge)\n                .WithUnlock(new ItemUnlock\n                {\n                    UnlockCost = 10,\n                    LoadoutCost = 5,\n                    CharacterCreationCost = 3,\n                    Prerequisites = { VanillaItems.Antidote },\n                });\n            */\n        }\n\n        public override void SetupDetails()\n        {\n            Item.itemType = ItemTypes.Combine;\n            Item.itemValue = 8;\n            Item.initCount = 10;\n            Item.stackable = true;\n            Item.hasCharges = true;\n        }\n\n        private static readonly Dictionary<string, string> invertDictionary = new Dictionary<string, string>\n        {\n            [VanillaEffects.Poisoned] = VanillaEffects.RegenerateHealth,\n            [VanillaEffects.Slow] = VanillaEffects.Fast,\n            [VanillaEffects.Weak] = VanillaEffects.Strength,\n            [VanillaEffects.Acid] = VanillaEffects.Invincible,\n            [VanillaEffects.Confused] = VanillaEffects.Invisible,\n        };\n        static Centrifuge()\n        {\n            foreach (KeyValuePair<string, string> pair in invertDictionary.ToArray())\n                invertDictionary.Add(pair.Value, pair.Key);\n        }\n\n        public bool CombineFilter(InvItem other) => other.invItemName == VanillaItems.Syringe\n            && other.contents.Count > 0 && invertDictionary.ContainsKey(other.contents[0]);\n        public bool CombineItems(InvItem other)\n        {\n            if (!CombineFilter(other)) return false;\n\n            other.contents[0] = invertDictionary[other.contents[0]];\n\n            Count--;\n            gc.audioHandler.Play(Owner, VanillaAudio.CombineItem);\n            return true;\n        }\n        public CustomTooltip CombineCursorText(InvItem other) => default;\n        public CustomTooltip CombineTooltip(InvItem other) => default;\n    }\n}\n';var d=n(5306);const h='using UnityEngine;\n\nnamespace RogueLibsCore.Test\n{\n    [ItemCategories(RogueCategories.Technology, RogueCategories.GunAccessory, RogueCategories.Guns)]\n    public class AmmoBox : CustomItem, IItemCombinable\n    {\n        [RLSetup]\n        public static void Setup()\n        {\n            RogueLibs.CreateCustomItem<AmmoBox>()\n                .WithName(new CustomNameInfo("Ammo Box"))\n                .WithDescription(new CustomNameInfo("Combine with any refillable weapon to refill it. Limited ammo."))\n                .WithSprite(Properties.Resources.AmmoBox)\n                .WithUnlock(new ItemUnlock\n                {\n                    UnlockCost = 10,\n                    LoadoutCost = 5,\n                    CharacterCreationCost = 3,\n                    Prerequisites = { VanillaItems.KillAmmunizer },\n                });\n        }\n\n        public override void SetupDetails()\n        {\n            Item.itemType = ItemTypes.Combine;\n            Item.itemValue = 4;\n            Item.initCount = 100;\n            Item.rewardCount = 200;\n            Item.hasCharges = true;\n            Item.stackable = true;\n        }\n        public bool CombineFilter(InvItem other) => other.itemType == ItemTypes.WeaponProjectile && !other.noRefills;\n        public bool CombineItems(InvItem other)\n        {\n            if (!CombineFilter(other))\n            {\n                gc.audioHandler.Play(Owner, VanillaAudio.CantDo);\n                return false;\n            }\n            if (other.invItemCount >= other.maxAmmo)\n            {\n                Owner!.SayDialogue("AmmoDispenserFull");\n                gc.audioHandler.Play(Owner, VanillaAudio.CantDo);\n                return false;\n            }\n\n            int amountToRefill = other.maxAmmo - other.invItemCount;\n            float singleCost = (float)other.itemValue / other.maxAmmo;\n            if (Owner!.oma.superSpecialAbility && Owner.agentName is VanillaAgents.Soldier or VanillaAgents.Doctor)\n                singleCost = 0f;\n\n            int affordableAmount = (int)Mathf.Ceil(Count / singleCost);\n            int willBeBought = Mathf.Min(affordableAmount, amountToRefill);\n            int willBeReduced = (int)Mathf.Min(Count, willBeBought * singleCost);\n\n            Count -= willBeReduced;\n            other.invItemCount += willBeBought;\n            Owner.SayDialogue("AmmoDispenserFilled");\n            gc.audioHandler.Play(Owner, VanillaAudio.BuyItem);\n            return true;\n        }\n\n        public CustomTooltip CombineTooltip(InvItem other)\n        {\n            if (!CombineFilter(other)) return default;\n\n            int amountToRefill = other.maxAmmo - other.invItemCount;\n            if (amountToRefill == 0) return default;\n\n            float singleCost = (float)other.itemValue / other.maxAmmo;\n            if (Owner!.oma.superSpecialAbility && Owner.agentName is VanillaAgents.Soldier or VanillaAgents.Doctor)\n                singleCost = 0f;\n            int cost = (int)Mathf.Floor(amountToRefill * singleCost);\n            int canAfford = (int)Mathf.Ceil(Count / singleCost);\n\n            return "+" + Mathf.Min(amountToRefill, canAfford) + " (" + Mathf.Min(cost, Count) + ")";\n        }\n\n        public CustomTooltip CombineCursorText(InvItem other) => gc.nameDB.GetName("RefillGun", NameTypes.Interface);\n        // it\'s one of the vanilla dialogues, so there\'s no need to define it in the mod\n    }\n}\n',b={},C="Combinable Items",f={unversionedId:"dev/items/combinable-items",id:"dev/items/combinable-items",title:"Combinable Items",description:"Custom items can be made combinable with other items by implementing the IItemCombinable interface. You can define what kind of items your item is combinable with, what happens when you combine these items, and what tooltips to display in the combinable item's cell, and when hovering over it.",source:"@site/docs/dev/items/combinable-items.mdx",sourceDirName:"dev/items",slug:"/dev/items/combinable-items",permalink:"/RogueLibs/docs/dev/items/combinable-items",draft:!1,editUrl:"https://github.com/Chasmical/RogueLibs/edit/main/website/docs/dev/items/combinable-items.mdx",tags:[],version:"current",frontMatter:{},sidebar:"documentationSidebar",previous:{title:"Usable Items",permalink:"/RogueLibs/docs/dev/items/usable-items"},next:{title:"Targetable Items",permalink:"/RogueLibs/docs/dev/items/targetable-items"}},g={};function v(e){let{props:t}=e;const[n,o]=(0,i.useState)((0,s.Z)("/img/TestItem.png")),[l,r]=(0,i.useState)("#FFED00"),[u,c]=(0,i.useState)("$123");return(0,a.kt)("div",{style:{padding:"10px",border:"5px dashed var(--ifm-menu-color-background-hover)",width:"max-content"}},(0,a.kt)("input",{type:"file",accept:"image/*",onChange:e=>{if(e.target.files[0]){const t=new FileReader;t.addEventListener("load",(()=>o(t.result))),t.readAsDataURL(e.target.files[0])}},style:{margin:"5px"}}),(0,a.kt)("div",{style:{margin:"5px"}},(0,a.kt)(m.Z,{sprite:n,tooltip:u,tooltipColor:l,mdxType:"InventorySlot"})),(0,a.kt)("input",{type:"text",placeholder:"$123",onChange:e=>c(e.target.value),style:{fontSize:"22px",margin:"5px"}}),(0,a.kt)("input",{type:"color",value:l,onChange:e=>r(e.target.value)}))}const I=[{value:"Making items combinable",id:"making-combinable",level:2},{value:"Inventory Slot Preview",id:"slot-preview",level:3},{value:"Examples",id:"examples",level:2}],k={PreviewTooltip:v,toc:I},y="wrapper";function w(e){let{components:t,...n}=e;return(0,a.kt)(y,(0,o.Z)({},k,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"combinable-items"},"Combinable Items"),(0,a.kt)("p",null,"Custom items can be made combinable with other items by implementing the ",(0,a.kt)("inlineCode",{parentName:"p"},"IItemCombinable")," interface. You can define what kind of items your item is combinable with, what happens when you combine these items, and what tooltips to display in the combinable item's cell, and when hovering over it."),(0,a.kt)("h2",{id:"making-combinable"},"Making items combinable"),(0,a.kt)("p",null,"Just implement the ",(0,a.kt)("inlineCode",{parentName:"p"},"IItemCombinable")," interface in your item's class:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csharp",metastring:'title="MyCombinableItem.cs"',title:'"MyCombinableItem.cs"'},"// highlight-next-line\npublic class MyCombinableItem : CustomItem, IItemCombinable\n{\n    // highlight-start\n    public bool CombineFilter(InvItem other) { /* ... */ }\n    public bool CombineItems(InvItem other) { /* ... */ }\n    public CustomTooltip CombineTooltip(InvItem other) { /* ... */ }\n    public CustomTooltip CombineCursorText(InvItem other) { /* ... */ }\n    // highlight-end\n}\n")),(0,a.kt)("p",null,"Plus, your item's type must be ",(0,a.kt)("inlineCode",{parentName:"p"},'"Combine"'),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csharp"},"    public override void SetupDetails()\n    {\n        // highlight-next-line\n        Item.itemType = ItemTypes.Combine;\n        /* ... */\n    }\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"CombineFilter")," determines what items will be highlighted, when combining the current item."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"CombineItems")," combines the current item with the other one. The return value indicates whether it was a success or not. Usually you'd just play a ",(0,a.kt)("inlineCode",{parentName:"p"},'"CantDo"')," sound, if the items cannot be combined. Returning ",(0,a.kt)("inlineCode",{parentName:"p"},"true")," will also play an animation."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"CombineTooltip")," determines the tooltip in the upper-left corner of the inventory slot. ",(0,a.kt)("inlineCode",{parentName:"p"},"Text")," set to ",(0,a.kt)("inlineCode",{parentName:"p"},"null")," will default to an empty string, and ",(0,a.kt)("inlineCode",{parentName:"p"},"Color")," set to ",(0,a.kt)("inlineCode",{parentName:"p"},"null")," will default to ",(0,a.kt)(u.Z,{color:"#FFED00",mdxType:"ColorSquare"}),". ",(0,a.kt)("a",{parentName:"p",href:"#slot-preview"},"See the tool below"),"."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"CombineCursorText")," determines the cursor text when hovering over the item. ",(0,a.kt)("inlineCode",{parentName:"p"},"Text")," set to ",(0,a.kt)("inlineCode",{parentName:"p"},"null"),' will default to "Combine", and ',(0,a.kt)("inlineCode",{parentName:"p"},"Color")," set to ",(0,a.kt)("inlineCode",{parentName:"p"},"null")," will default to ",(0,a.kt)(u.Z,{color:"#FFFFFF",mdxType:"ColorSquare"}),"."),(0,a.kt)("h3",{id:"slot-preview"},"Inventory Slot Preview"),(0,a.kt)("p",null,"Wanna see how your ",(0,a.kt)("inlineCode",{parentName:"p"},"CombineTooltip")," will look in the game? Check out this small tool:"),(0,a.kt)(v,{mdxType:"PreviewTooltip"}),(0,a.kt)("h2",{id:"examples"},"Examples"),(0,a.kt)(l.Z,{defaultValue:"ammobox",values:[{label:"Centrifuge",value:"centrifuge"},{label:"Spice Rack",value:"spicerack"},{label:"Ammo Box",value:"ammobox"}],mdxType:"Tabs"},(0,a.kt)(r.Z,{value:"centrifuge",mdxType:"TabItem"},(0,a.kt)("p",null,"A simple example that inverts the Syringes' effects."),(0,a.kt)(c.Z,{mdxType:"CodeSnippet"},p)),(0,a.kt)(r.Z,{value:"spicerack",mdxType:"TabItem"},(0,a.kt)("p",null,"A simple example, with custom hooks to keep track of seasoned items."),(0,a.kt)("p",null,"See more about custom hooks ",(0,a.kt)("a",{parentName:"p",href:"/RogueLibs/docs/dev/hooks/"},"here"),"."),(0,a.kt)(c.Z,{mdxType:"CodeSnippet"},d.Z)),(0,a.kt)(r.Z,{value:"ammobox",mdxType:"TabItem"},(0,a.kt)("p",null,"A pretty complicated example with a lot of math."),(0,a.kt)(c.Z,{mdxType:"CodeSnippet"},h))))}w.isMDXComponent=!0},5306:(e,t,n)=>{n.d(t,{Z:()=>o});const o='using UnityEngine;\n\nnamespace RogueLibsCore.Test\n{\n    [ItemCategories(RogueCategories.Food, RogueCategories.Health)]\n    public class SpiceRack : CustomItem, IItemCombinable\n    {\n        [RLSetup]\n        public static void Setup()\n        {\n            RogueLibs.CreateCustomItem<SpiceRack>()\n                .WithName(new CustomNameInfo("Spice Rack"))\n                .WithDescription(new CustomNameInfo("Combine with any food item to increase its healing properties."))\n                .WithSprite(Properties.Resources.SpiceRack)\n                .WithUnlock(new ItemUnlock\n                {\n                    UnlockCost = 10,\n                    LoadoutCost = 3,\n                    CharacterCreationCost = 2,\n                    Prerequisites = { VanillaItems.FoodProcessor },\n                });\n\n            SeasonCursorText = RogueLibs.CreateCustomName("SeasonItem", NameTypes.Interface, new CustomNameInfo("Season"));\n        }\n        private static CustomName SeasonCursorText = null!;\n\n        public override void SetupDetails()\n        {\n            Item.itemType = ItemTypes.Combine;\n            Item.itemValue = 4;\n            Item.initCount = 10;\n            Item.rewardCount = 15;\n            Item.stackable = true;\n            Item.hasCharges = true;\n        }\n        public bool CombineFilter(InvItem other)\n        {\n            if (other.itemType != ItemTypes.Food || other.healthChange is 0\n                || !other.Categories.Contains(RogueCategories.Food)) return false;\n\n            SpicedHook? hook = other.GetHook<SpicedHook>();\n            return hook is null || hook.Spiciness < 3;\n        }\n        public bool CombineItems(InvItem other)\n        {\n            if (!CombineFilter(other)) return false;\n\n            SpicedHook hook = other.GetHook<SpicedHook>() ?? other.AddHook<SpicedHook>();\n            hook.IncreaseSpiciness();\n\n            Count--;\n            gc.audioHandler.Play(Owner, VanillaAudio.CombineItem);\n            return true;\n        }\n        public CustomTooltip CombineCursorText(InvItem other) => SeasonCursorText;\n        public CustomTooltip CombineTooltip(InvItem other)\n        {\n            if (!CombineFilter(other)) return default;\n\n            SpicedHook? hook = other.GetHook<SpicedHook>();\n            int bonus = hook is null ? (int)Mathf.Ceil(other.healthChange / 4f) : hook.HealthBonus;\n            return new CustomTooltip($"+{bonus}", Color.green);\n        }\n\n        private class SpicedHook : HookBase<InvItem>\n        {\n            protected override void Initialize()\n                => HealthBonus = (int)Mathf.Ceil(Instance.healthChange / 4f);\n\n            public int HealthBonus { get; private set; }\n            public int Spiciness { get; private set; }\n\n            public void IncreaseSpiciness()\n            {\n                if (Spiciness is 3) return;\n\n                Spiciness++;\n                Instance.healthChange += HealthBonus;\n            }\n        }\n    }\n}\n'}}]);