"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[5399],{4214:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(7294),i=n(3066);function l(e){let{children:t,language:n}=e;return a.createElement(i.Z,{className:"language-"+(n||"csharp")},t.replace(/\t/g,"    "))}},1016:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(7462),i=n(7294);function l(e){let{children:t,...n}=e;return i.createElement("div",(0,a.Z)({role:"tabpanel"},n),t)}},250:(e,t,n)=>{n.d(t,{Z:()=>d});var a=n(7294),i=n(7094),l=n(6010);const s="tabItem_V91s",r="tabItemActive_JsUu",o="tab_ntnM";const u=37,g=39;function d(e){const{lazy:t,defaultValue:n,values:d,groupId:c}=e,{tabGroupChoices:m,setTabGroupChoices:b}=(0,i.U)(),[p,h]=(0,a.useState)(n),y=a.Children.toArray(e.children),C=[];if(null!=c){const e=m[c];null!=e&&e!==p&&d.some((t=>t.value===e))&&h(e)}const v=e=>{const t=e.currentTarget,n=C.indexOf(t),a=d[n].value;h(a),null!=c&&(b(c,a),setTimeout((()=>{(function(e){const{top:t,left:n,bottom:a,right:i}=e.getBoundingClientRect(),{innerHeight:l,innerWidth:s}=window;return t>=0&&i<=s&&a<=l&&n>=0})(t)||(t.scrollIntoView({block:"center",behavior:"smooth"}),t.classList.add(r),setTimeout((()=>t.classList.remove(r)),2e3))}),150))},f=e=>{let t;switch(e.keyCode){case g:{const n=C.indexOf(e.target)+1;t=C[n]||C[0];break}case u:{const n=C.indexOf(e.target)-1;t=C[n]||C[C.length-1];break}default:return}t.focus()},N=(e,t)=>t.value===e||t.values&&-1!=t.values.indexOf(e);return a.createElement("div",{className:"tabs-container"},a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:"tabs"},d.map((e=>{let{value:t,label:n}=e;return a.createElement("li",{role:"tab",tabIndex:p===t?0:-1,"aria-selected":p===t,className:(0,l.Z)("tabs__item",s,{"tabs__item--active":p===t}),key:t,ref:e=>e&&C.push(e),onKeyDown:f,onFocus:v,onClick:v},n)}))),t?a.cloneElement(y.find((e=>N(p,e.props))),{className:o}):a.createElement("div",null,y.map(((e,t)=>a.cloneElement(e,{key:t,hidden:!N(p,e.props),className:o})))),a.createElement("br",null))}},1707:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>u,default:()=>b,frontMatter:()=>o,metadata:()=>g,toc:()=>c});var a=n(7462),i=(n(7294),n(3905)),l=n(250),s=n(1016),r=(n(4996),n(4214));const o={},u="Targetable Abilities",g={unversionedId:"dev/items/abilities/targetable-abilities",id:"dev/items/abilities/targetable-abilities",title:"Targetable Abilities",description:"Making abilities targetable",source:"@site/docs/dev/items/abilities/targetable-abilities.mdx",sourceDirName:"dev/items/abilities",slug:"/dev/items/abilities/targetable-abilities",permalink:"/RogueLibs/docs/dev/items/abilities/targetable-abilities",draft:!1,editUrl:"https://github.com/SugarBarrel/RogueLibs/edit/main/website/docs/dev/items/abilities/targetable-abilities.mdx",tags:[],version:"current",frontMatter:{},sidebar:"documentationSidebar",previous:{title:"Chargeable Abilities",permalink:"/RogueLibs/docs/dev/items/abilities/chargeable-abilities"},next:{title:"Creating a Custom Trait",permalink:"/RogueLibs/docs/dev/traits/create-trait"}},d={},c=[{value:"Making abilities targetable",id:"making-targetable",level:2},{value:"Examples",id:"examples",level:2}],m={toc:c};function b(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"targetable-abilities"},"Targetable Abilities"),(0,i.kt)("h2",{id:"making-targetable"},"Making abilities targetable"),(0,i.kt)("p",null,"Just implement the ",(0,i.kt)("inlineCode",{parentName:"p"},"IAbilityTargetable")," interface in your ability's class:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-csharp",metastring:'title="MyTargetableAbility.cs"',title:'"MyTargetableAbility.cs"'},"// highlight-next-line\npublic class MyTargetableAbility : CustomAbility, IAbilityTargetable\n{\n    // highlight-next-line\n    public PlayfieldObject FindTarget() { /* ... */ }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"FindTarget")," determines the closest target, that the ability can be used on. An ability indicator will be displayed over that object. If the ability cannot be used right now, you should return ",(0,i.kt)("inlineCode",{parentName:"p"},"null"),"."),(0,i.kt)("p",null,"Then, you can use ",(0,i.kt)("inlineCode",{parentName:"p"},"CurrentTarget")," in any of the methods:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-csharp"},'    public override void OnPressed()\n    {\n        if (CurrentTarget is null)\n        {\n            gc.audioHandler.Play(Owner, "CantDo");\n            return;\n        }\n        /* ... */\n    }\n')),(0,i.kt)("h2",{id:"examples"},"Examples"),(0,i.kt)(l.Z,{defaultValue:"hug",values:[{label:"Hug",value:"hug"}],mdxType:"Tabs"},(0,i.kt)(s.Z,{value:"hug",mdxType:"TabItem"},(0,i.kt)(r.Z,{mdxType:"CodeSnippet"},'using System.Collections.Generic;\nusing System.Linq;\nusing UnityEngine;\n\nnamespace RogueLibsCore.Test\n{\n    public class Hug : CustomAbility, IAbilityTargetable\n    {\n        [RLSetup]\n        public static void Setup()\n        {\n            RogueLibs.CreateCustomAbility<Hug>()\n                .WithName(new CustomNameInfo("Hug"))\n                .WithDescription(new CustomNameInfo("Sneak up behind people. And HUG THEM!!"))\n                .WithSprite(Properties.Resources.Hug)\n                .WithUnlock(new AbilityUnlock { UnlockCost = 5, CharacterCreationCost = 5 });\n\n            RogueLibs.CreateCustomName("HugNegative1", NameTypes.Dialogue, new CustomNameInfo("Huh? What are you doing?"));\n            RogueLibs.CreateCustomName("HugNegative2", NameTypes.Dialogue, new CustomNameInfo("Excuse me?!"));\n            RogueLibs.CreateCustomName("HugNegative3", NameTypes.Dialogue, new CustomNameInfo("Stop it!"));\n            RogueLibs.CreateCustomName("HugPositive1", NameTypes.Dialogue, new CustomNameInfo("Oh.. Thanks."));\n            RogueLibs.CreateCustomName("HugPositive2", NameTypes.Dialogue, new CustomNameInfo("Um.. Okay.."));\n            RogueLibs.CreateCustomName("HugPositive3", NameTypes.Dialogue, new CustomNameInfo("?.."));\n            RogueLibs.CreateCustomName("HugForgive1", NameTypes.Dialogue, new CustomNameInfo("Oh.. Okay, I forgive you."));\n            RogueLibs.CreateCustomName("HugForgive2", NameTypes.Dialogue, new CustomNameInfo("Alright, I forgive you."));\n            RogueLibs.CreateCustomName("HugForgive3", NameTypes.Dialogue, new CustomNameInfo("Okay... Don\'t worry about that.."));\n        }\n\n        public override void OnAdded() { }\n        public PlayfieldObject? FindTarget()\n        {\n            Agent? closest = null;\n            float distance = float.MaxValue;\n            foreach (Agent agent in Owner.interactionHelper.TriggerList\n                .Where(static go => go.CompareTag("AgentSprite"))\n                .Select(static go => go.GetComponent<ObjectSprite>().agent))\n            {\n                if (!huggedList.Contains(agent) && !agent.dead && !agent.ghost && !Owner.ghost && !agent.hologram\n                    && agent.go.activeSelf && !agent.mechFilled && !agent.mechEmpty)\n                {\n                    float dist = Vector2.Distance(Owner.curPosition, agent.curPosition);\n                    if (dist < distance)\n                    {\n                        closest = agent;\n                        distance = dist;\n                    }\n                }\n            }\n            return closest;\n        }\n        private readonly List<Agent> huggedList = new List<Agent>();\n        public override void OnPressed()\n        {\n            if (CurrentTarget is null)\n            {\n                gc.audioHandler.Play(Owner, VanillaAudio.CantDo);\n            }\n            else\n            {\n                Agent target = (Agent)CurrentTarget;\n                int rnd = new System.Random().Next(3) + 1;\n\n                relStatus code = target.relationships.GetRelCode(Owner);\n                if (code is relStatus.Friendly or relStatus.Submissive)\n                {\n                    target.SayDialogue("HugPositive" + rnd);\n                    target.relationships.SetRel(Owner, "Loyal");\n                }\n                else if (code == relStatus.Loyal)\n                {\n                    target.SayDialogue("HugPositive" + rnd);\n                    target.relationships.SetRel(Owner, "Aligned");\n                }\n                else if (code == relStatus.Aligned)\n                {\n                    target.SayDialogue("HugPositive" + rnd);\n                }\n                else if (code == relStatus.Neutral)\n                {\n                    target.SayDialogue("HugNegative" + rnd);\n                    target.relationships.SetRel(Owner, "Annoyed");\n                    target.relationships.SetStrikes(Owner, 2);\n                    target.statusEffects.annoyeders.Add(Owner);\n                    gc.audioHandler.Play(target, VanillaAudio.AgentAnnoyed);\n                    return;\n                }\n                else if (code == relStatus.Annoyed)\n                {\n                    target.SayDialogue("HugForgive" + rnd);\n                    target.relationships.SetRel(Owner, "Neutral");\n                }\n                else if (code == relStatus.Hostile)\n                {\n                    return;\n                }\n                target.relationships.SetStrikes(Owner, 0);\n                gc.audioHandler.Play(target, VanillaAudio.AgentOK);\n                huggedList.Add(target);\n            }\n        }\n    }\n}\n'))))}b.isMDXComponent=!0}}]);