"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[5399],{4214:function(t,e,n){n.d(e,{Z:function(){return r}});var a=n(7294),i=n(9055);function r(t){var e=t.children,n=t.language;return a.createElement(i.Z,{className:"language-"+(n||"csharp")},e.replace(/\t/g,"    "))}},1016:function(t,e,n){n.d(e,{Z:function(){return o}});var a=n(7462),i=n(3366),r=n(7294),l=["children"];function o(t){var e=t.children,n=(0,i.Z)(t,l);return r.createElement("div",(0,a.Z)({role:"tabpanel"},n),e)}},2099:function(t,e,n){n.d(e,{Z:function(){return d}});var a=n(7294),i=n(9443);var r=function(){var t=(0,a.useContext)(i.Z);if(null==t)throw new Error('"useUserPreferencesContext" is used outside of "Layout" component.');return t},l=n(6010),o="tabItem_OdQc",s="tabItemActive_YQWB",u="tab_tgHH";var g=37,c=39;function d(t){var e=t.lazy,n=t.defaultValue,i=t.values,d=t.groupId,m=r(),b=m.tabGroupChoices,p=m.setTabGroupChoices,h=(0,a.useState)(n),f=h[0],v=h[1],y=a.Children.toArray(t.children),C=[];if(null!=d){var N=b[d];null!=N&&N!==f&&i.some((function(t){return t.value===N}))&&v(N)}var k=function(t){var e=t.currentTarget,n=C.indexOf(e),a=i[n].value;v(a),null!=d&&(p(d,a),setTimeout((function(){var t,n,a,i,r,l,o,u;(t=e.getBoundingClientRect(),n=t.top,a=t.left,i=t.bottom,r=t.right,l=window,o=l.innerHeight,u=l.innerWidth,n>=0&&r<=u&&i<=o&&a>=0)||(e.scrollIntoView({block:"center",behavior:"smooth"}),e.classList.add(s),setTimeout((function(){return e.classList.remove(s)}),2e3))}),150))},w=function(t){var e;switch(t.keyCode){case c:var n=C.indexOf(t.target)+1;e=C[n]||C[0];break;case g:var a=C.indexOf(t.target)-1;e=C[a]||C[C.length-1];break;default:return}e.focus()},T=function(t,e){return e.value===t||e.values&&-1!=e.values.indexOf(t)};return a.createElement("div",{className:"tabs-container"},a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:"tabs"},i.map((function(t){var e=t.value,n=t.label;return a.createElement("li",{role:"tab",tabIndex:f===e?0:-1,"aria-selected":f===e,className:(0,l.Z)("tabs__item",o,{"tabs__item--active":f===e}),key:e,ref:function(t){return t&&C.push(t)},onKeyDown:w,onFocus:k,onClick:k},n)}))),e?a.cloneElement(y.find((function(t){return T(f,t.props)})),{className:u}):a.createElement("div",null,y.map((function(t,e){return a.cloneElement(t,{key:e,hidden:!T(f,t.props),className:u})}))),a.createElement("br",null))}},1707:function(t,e,n){n.r(e),n.d(e,{contentTitle:function(){return c},default:function(){return p},frontMatter:function(){return g},metadata:function(){return d},toc:function(){return m}});var a=n(7462),i=n(3366),r=(n(7294),n(3905)),l=n(2099),o=n(1016),s=(n(4996),n(4214)),u=["components"],g={},c="Targetable Abilities",d={unversionedId:"dev/items/abilities/targetable-abilities",id:"dev/items/abilities/targetable-abilities",title:"Targetable Abilities",description:"Making abilities targetable",source:"@site/docs/dev/items/abilities/targetable-abilities.mdx",sourceDirName:"dev/items/abilities",slug:"/dev/items/abilities/targetable-abilities",permalink:"/RogueLibs/docs/dev/items/abilities/targetable-abilities",editUrl:"https://github.com/SugarBarrel/RogueLibs/edit/main/website/docs/dev/items/abilities/targetable-abilities.mdx",tags:[],version:"current",frontMatter:{},sidebar:"documentationSidebar",previous:{title:"Chargeable Abilities",permalink:"/RogueLibs/docs/dev/items/abilities/chargeable-abilities"},next:{title:"Creating a Custom Trait",permalink:"/RogueLibs/docs/dev/traits/create-trait"}},m=[{value:"Making abilities targetable",id:"making-targetable",children:[],level:2},{value:"Examples",id:"examples",children:[],level:2}],b={toc:m};function p(t){var e=t.components,n=(0,i.Z)(t,u);return(0,r.kt)("wrapper",(0,a.Z)({},b,n,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"targetable-abilities"},"Targetable Abilities"),(0,r.kt)("h2",{id:"making-targetable"},"Making abilities targetable"),(0,r.kt)("p",null,"Just implement the ",(0,r.kt)("inlineCode",{parentName:"p"},"IAbilityTargetable")," interface in your ability's class:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp",metastring:'title="MyTargetableAbility.cs"',title:'"MyTargetableAbility.cs"'},"// highlight-next-line\npublic class MyTargetableAbility : CustomAbility, IAbilityTargetable\n{\n    // highlight-next-line\n    public PlayfieldObject FindTarget() { /* ... */ }\n}\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"FindTarget")," determines the closest target, that the ability can be used on. An ability indicator will be displayed over that object. If the ability cannot be used right now, you should return ",(0,r.kt)("inlineCode",{parentName:"p"},"null"),"."),(0,r.kt)("p",null,"Then, you can use ",(0,r.kt)("inlineCode",{parentName:"p"},"CurrentTarget")," in any of the methods:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp"},'    public override void OnPressed()\n    {\n        if (CurrentTarget is null)\n        {\n            gc.audioHandler.Play(Owner, "CantDo");\n            return;\n        }\n        /* ... */\n    }\n')),(0,r.kt)("h2",{id:"examples"},"Examples"),(0,r.kt)(l.Z,{defaultValue:"hug",values:[{label:"Hug",value:"hug"}],mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"hug",mdxType:"TabItem"},(0,r.kt)(s.Z,{mdxType:"CodeSnippet"},'using System.Collections.Generic;\nusing System.Linq;\nusing UnityEngine;\n\nnamespace RogueLibsCore.Test\n{\n\tpublic class Hug : CustomAbility, IAbilityTargetable\n\t{\n\t\t[RLSetup]\n\t\tpublic static void Setup()\n\t\t{\n\t\t\tRogueLibs.CreateCustomAbility<Hug>()\n\t\t\t\t.WithName(new CustomNameInfo("Hug"))\n\t\t\t\t.WithDescription(new CustomNameInfo("Sneak up behind people. And HUG THEM!!"))\n\t\t\t\t.WithSprite(Properties.Resources.Hug)\n\t\t\t\t.WithUnlock(new AbilityUnlock { UnlockCost = 5, CharacterCreationCost = 5, });\n\n\t\t\tRogueLibs.CreateCustomName("HugNegative1", NameTypes.Dialogue, new CustomNameInfo("Huh? What are you doing?"));\n\t\t\tRogueLibs.CreateCustomName("HugNegative2", NameTypes.Dialogue, new CustomNameInfo("Excuse me?!"));\n\t\t\tRogueLibs.CreateCustomName("HugNegative3", NameTypes.Dialogue, new CustomNameInfo("Stop it!"));\n\t\t\tRogueLibs.CreateCustomName("HugPositive1", NameTypes.Dialogue, new CustomNameInfo("Oh.. Thanks."));\n\t\t\tRogueLibs.CreateCustomName("HugPositive2", NameTypes.Dialogue, new CustomNameInfo("Um.. Okay.."));\n\t\t\tRogueLibs.CreateCustomName("HugPositive3", NameTypes.Dialogue, new CustomNameInfo("?.."));\n\t\t\tRogueLibs.CreateCustomName("HugForgive1", NameTypes.Dialogue, new CustomNameInfo("Oh.. Okay, I forgive you."));\n\t\t\tRogueLibs.CreateCustomName("HugForgive2", NameTypes.Dialogue, new CustomNameInfo("Alright, I forgive you."));\n\t\t\tRogueLibs.CreateCustomName("HugForgive3", NameTypes.Dialogue, new CustomNameInfo("Okay... Don\'t worry about that.."));\n\t\t}\n\n\t\tpublic override void OnAdded() { }\n\t\tpublic PlayfieldObject FindTarget()\n\t\t{\n\t\t\tAgent closest = null;\n\t\t\tfloat distance = float.MaxValue;\n\t\t\tforeach (Agent agent in Owner.interactionHelper.TriggerList\n\t\t\t\t.Where(go => go.CompareTag("AgentSprite")).Select(go => go.GetComponent<ObjectSprite>().agent))\n\t\t\t{\n\t\t\t\tif (!huggedList.Contains(agent) && !agent.dead && !agent.ghost && !Owner.ghost && !agent.hologram && agent.go.activeSelf && !agent.mechFilled && !agent.mechEmpty)\n\t\t\t\t{\n\t\t\t\t\tfloat dist = Vector2.Distance(Owner.curPosition, agent.curPosition);\n\t\t\t\t\tif (dist < distance)\n\t\t\t\t\t{\n\t\t\t\t\t\tclosest = agent;\n\t\t\t\t\t\tdistance = dist;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn closest;\n\t\t}\n\t\tprivate readonly List<Agent> huggedList = new List<Agent>();\n\t\tpublic override void OnPressed()\n\t\t{\n\t\t\tif (CurrentTarget is null)\n\t\t\t{\n\t\t\t\tgc.audioHandler.Play(Owner, VanillaAudio.CantDo);\n}\n\t\t\telse\n\t\t\t{\n\t\t\t\tAgent target = (Agent)CurrentTarget;\n\t\t\t\tint rnd = new System.Random().Next(3) + 1;\n\n\t\t\t\trelStatus code = target.relationships.GetRelCode(Owner);\n\t\t\t\tif (code == relStatus.Friendly || code == relStatus.Submissive)\n\t\t\t\t{\n\t\t\t\t\ttarget.SayDialogue("HugPositive" + rnd);\n\t\t\t\t\ttarget.relationships.SetRel(Owner, "Loyal");\n\t\t\t\t}\n\t\t\t\telse if (code == relStatus.Loyal)\n\t\t\t\t{\n\t\t\t\t\ttarget.SayDialogue("HugPositive" + rnd);\n\t\t\t\t\ttarget.relationships.SetRel(Owner, "Aligned");\n\t\t\t\t}\n\t\t\t\telse if (code == relStatus.Aligned)\n\t\t\t\t{\n\t\t\t\t\ttarget.SayDialogue("HugPositive" + rnd);\n\t\t\t\t}\n\t\t\t\telse if (code == relStatus.Neutral)\n\t\t\t\t{\n\t\t\t\t\ttarget.SayDialogue("HugNegative" + rnd);\n\t\t\t\t\ttarget.relationships.SetRel(Owner, "Annoyed");\n\t\t\t\t\ttarget.relationships.SetStrikes(Owner, 2);\n\t\t\t\t\ttarget.statusEffects.annoyeders.Add(Owner);\n\t\t\t\t\tgc.audioHandler.Play(target, VanillaAudio.AgentAnnoyed);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\telse if (code == relStatus.Annoyed)\n\t\t\t\t{\n\t\t\t\t\ttarget.SayDialogue("HugForgive" + rnd);\n\t\t\t\t\ttarget.relationships.SetRel(Owner, "Neutral");\n\t\t\t\t}\n\t\t\t\telse if (code == relStatus.Hostile)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\ttarget.relationships.SetStrikes(Owner, 0);\n\t\t\t\tgc.audioHandler.Play(target, VanillaAudio.AgentOK);\n\t\t\t\thuggedList.Add(target);\n\t\t\t}\n\t\t}\n\t}\n}\n'))))}p.isMDXComponent=!0}}]);