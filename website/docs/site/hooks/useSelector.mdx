# `useSelector`

import useBaseUrl from '@docusaurus/useBaseUrl';
import BrowserWindow from '@site/src/components/BrowserWindow';
import InventoryGrid from '@site/src/components/InventoryGrid';
import InventoryRow from '@site/src/components/InventoryRow';
import InventorySlot from '@site/src/components/InventorySlot';
import Tabs from '@site/src/components/Tabs';
import TabItem from '@site/src/components/TabItem';

`useSelector` hook is useful, when you need to add/remove/toggle certain values.

For example, it's used inside `InventoryRow`, `InventoryGrid` and other interactive components:

<InventoryGrid interactive={true} minChoices={1} maxChoices={3}>
  <InventoryRow>
    <InventorySlot uid="1" sprite={useBaseUrl("/img/Generic.png")}/>
    <InventorySlot uid="2" sprite={useBaseUrl("/img/Generic2.png")}/>
    <InventorySlot uid="3" sprite={useBaseUrl("/img/Generic3.png")}/>
  </InventoryRow>
  <InventoryRow>
    <InventorySlot uid="4" sprite={useBaseUrl("/img/Generic4.png")}/>
    <InventorySlot uid="5" sprite={useBaseUrl("/img/Generic5.png")}/>
    <InventorySlot uid="6" sprite={useBaseUrl("/img/Generic6.png")}/>
  </InventoryRow>
</InventoryGrid>

## Props {#props}

```ts
export type Props = SelectorParameters & {
  availableValues: (string | undefined)[] | null,
}
export interface SelectorParameters {
  defaultValues?: string | string[] | (() => string | string[] | undefined),
  minChoices?: number,
  maxChoices?: number,
  lockChoices?: boolean,
  group?: string,
  onChange?: (values: string[]) => void,
}
```

## Usage {#usage}

<Tabs defaultValue="ts"
  values={[
    {value:'ts', label:'TypeScript'},
    {value:'js', label:'JavaScript'},
  ]}>
<TabItem value="ts">

```ts
import useSelector, { SelectorParameters } from "../hooks/useSelector";

export type Props = SelectorParameters & {
  /* your props */
}

export default function ({/* your props */ ...pars}: Props) {

  if (pars.group) pars.group = `some.storage.slot.path.${pars.group}`;
  const [values, controller] = useSelector(availableValues, pars);

  /* ... */
}
```

</TabItem>
<TabItem value="js">

```js
import useSelector from "../hooks/useSelector";

export default function ({/* your props */ ...pars}) {

  if (pars.group) pars.group = `some.storage.slot.path.${pars.group}`;
  const [values, controller] = useSelector(availableValues, pars);

  /* ... */
}
```

</TabItem>
</Tabs>

`availableValues` is the array of all possible selected values. Set it to `null` if the creation of such array is not possible.

:::note
At the moment it's used only to select default values.
:::

Then you can use `controller`'s functions:

```ts
export type SelectorController = {
  add: (value: string) => void,     // adds a value
  remove: (values: string) => void, // removes a value
  toggle: (values: string) => void, // toggles a value
  set: (values: string[]) => void,  // sets the selected values
  isLocked: (value: string) => boolean,
  // alias for (values.length == (values.includes(value) ? MinChoices : MaxChoices))
}
```

In the examples below we'll be using `InventoryRow` to show some of the features.

## `minChoices` and `maxChoices` {#minchoices-maxchoices}

```ts
  minChoices?: number, // default: 0
  maxChoices?: number, // default: 1
```

`minChoices` specifies the minimum amount of selected slots.  
`maxChoices` specifies the maximum amount of selected slots. -1 ≡ ∞.

```jsx
<InventoryRow interactive={true} minChoices={1} maxChoices={3}>
  <InventorySlot uid="1" sprite={useBaseUrl("/img/Generic.png")}/>
  <InventorySlot uid="2" sprite={useBaseUrl("/img/Generic2.png")} count={25}/>
  <InventorySlot uid="3" sprite={useBaseUrl("/img/Generic3.png")} count={25} tooltip="$13"/>
  <InventorySlot uid="4" sprite={useBaseUrl("/img/Generic4.png")} count="$13" tooltip={25}/>
  <InventorySlot uid="5" sprite={useBaseUrl("/img/Generic5.png")} tooltip={25}/>
  <InventorySlot uid="6" sprite={useBaseUrl("/img/Generic6.png")}/>
</InventoryRow>
```

<BrowserWindow>
<InventoryRow interactive={true} minChoices={1} maxChoices={3}>
  <InventorySlot uid="1" sprite={useBaseUrl("/img/Generic.png")}/>
  <InventorySlot uid="2" sprite={useBaseUrl("/img/Generic2.png")} count={25}/>
  <InventorySlot uid="3" sprite={useBaseUrl("/img/Generic3.png")} count={25} tooltip="$13"/>
  <InventorySlot uid="4" sprite={useBaseUrl("/img/Generic4.png")} count="$13" tooltip={25}/>
  <InventorySlot uid="5" sprite={useBaseUrl("/img/Generic5.png")} tooltip={25}/>
  <InventorySlot uid="6" sprite={useBaseUrl("/img/Generic6.png")}/>
</InventoryRow>
</BrowserWindow>

## `defaultValues` {#default-values}

```ts
  defaultValues?: string | string[] | (() => string | string[] | undefined),
```

`defaultValues` can be a single string, an array of strings or a lazy function.

```jsx
<InventoryRow interactive={true} maxChoices={3} defaultValues={["2", "4"]}>
  <InventorySlot uid="1" sprite={useBaseUrl("/img/Generic.png")}/>
  <InventorySlot uid="2" sprite={useBaseUrl("/img/Generic2.png")} count={25}/>
  <InventorySlot uid="3" sprite={useBaseUrl("/img/Generic3.png")} count={25} tooltip="$13"/>
  <InventorySlot uid="4" sprite={useBaseUrl("/img/Generic4.png")} count="$13" tooltip={25}/>
  <InventorySlot uid="5" sprite={useBaseUrl("/img/Generic5.png")} tooltip={25}/>
  <InventorySlot uid="6" sprite={useBaseUrl("/img/Generic6.png")}/>
</InventoryRow>
```

<BrowserWindow>
<InventoryRow interactive={true} maxChoices={3} defaultValues={["2", "4"]}>
  <InventorySlot uid="1" sprite={useBaseUrl("/img/Generic.png")}/>
  <InventorySlot uid="2" sprite={useBaseUrl("/img/Generic2.png")} count={25}/>
  <InventorySlot uid="3" sprite={useBaseUrl("/img/Generic3.png")} count={25} tooltip="$13"/>
  <InventorySlot uid="4" sprite={useBaseUrl("/img/Generic4.png")} count="$13" tooltip={25}/>
  <InventorySlot uid="5" sprite={useBaseUrl("/img/Generic5.png")} tooltip={25}/>
  <InventorySlot uid="6" sprite={useBaseUrl("/img/Generic6.png")}/>
</InventoryRow>
</BrowserWindow>

If not set, or if the lazy function returns `undefined`, picks the first `minChoices` values:

```jsx
<InventoryRow interactive={true} minChoices={3} maxChoices={-1}>
  <InventorySlot uid="1" sprite={useBaseUrl("/img/Generic.png")}/>
  <InventorySlot uid="2" sprite={useBaseUrl("/img/Generic2.png")} count={25}/>
  <InventorySlot uid="3" sprite={useBaseUrl("/img/Generic3.png")} count={25} tooltip="$13"/>
  <InventorySlot uid="4" sprite={useBaseUrl("/img/Generic4.png")} count="$13" tooltip={25}/>
  <InventorySlot uid="5" sprite={useBaseUrl("/img/Generic5.png")} tooltip={25}/>
  <InventorySlot uid="6" sprite={useBaseUrl("/img/Generic6.png")}/>
</InventoryRow>
```

<BrowserWindow>
<InventoryRow interactive={true} minChoices={3} maxChoices={-1}>
  <InventorySlot uid="1" sprite={useBaseUrl("/img/Generic.png")}/>
  <InventorySlot uid="2" sprite={useBaseUrl("/img/Generic2.png")} count={25}/>
  <InventorySlot uid="3" sprite={useBaseUrl("/img/Generic3.png")} count={25} tooltip="$13"/>
  <InventorySlot uid="4" sprite={useBaseUrl("/img/Generic4.png")} count="$13" tooltip={25}/>
  <InventorySlot uid="5" sprite={useBaseUrl("/img/Generic5.png")} tooltip={25}/>
  <InventorySlot uid="6" sprite={useBaseUrl("/img/Generic6.png")}/>
</InventoryRow>
</BrowserWindow>

## `lockChoices` {#lockchoices}

You can "lock" the selected values with `lockChoices`.  
When the maximum selectable amount is reached, non-selected slots change to `"locked"` type.

```jsx
<InventoryRow interactive={true} maxChoices={2} lockChoices={true}>
  <InventorySlot uid="1" sprite={useBaseUrl("/img/Generic.png")}/>
  <InventorySlot uid="2" sprite={useBaseUrl("/img/Generic2.png")} count={25}/>
  <InventorySlot uid="3" sprite={useBaseUrl("/img/Generic3.png")} count={25} tooltip="$13"/>
  <InventorySlot uid="4" sprite={useBaseUrl("/img/Generic4.png")} count="$13" tooltip={25}/>
  <InventorySlot uid="5" sprite={useBaseUrl("/img/Generic5.png")} tooltip={25}/>
  <InventorySlot uid="6" sprite={useBaseUrl("/img/Generic6.png")}/>
</InventoryRow>
```

<BrowserWindow>
<InventoryRow interactive={true} maxChoices={2} lockChoices={true}>
  <InventorySlot uid="1" sprite={useBaseUrl("/img/Generic.png")}/>
  <InventorySlot uid="2" sprite={useBaseUrl("/img/Generic2.png")} count={25}/>
  <InventorySlot uid="3" sprite={useBaseUrl("/img/Generic3.png")} count={25} tooltip="$13"/>
  <InventorySlot uid="4" sprite={useBaseUrl("/img/Generic4.png")} count="$13" tooltip={25}/>
  <InventorySlot uid="5" sprite={useBaseUrl("/img/Generic5.png")} tooltip={25}/>
  <InventorySlot uid="6" sprite={useBaseUrl("/img/Generic6.png")}/>
</InventoryRow>
</BrowserWindow>

## `group` {#group}

You can use `group` to save the selected values in the local storage.  
Try selecting some slots and then reloading the page.

```jsx
<InventoryRow interactive={true} group="useSelectorDemo" maxChoices={4}>
  <InventorySlot uid="1" sprite={useBaseUrl("/img/Generic.png")}/>
  <InventorySlot uid="2" sprite={useBaseUrl("/img/Generic2.png")} count={25}/>
  <InventorySlot uid="3" sprite={useBaseUrl("/img/Generic3.png")} count={25} tooltip="$13"/>
  <InventorySlot uid="4" sprite={useBaseUrl("/img/Generic4.png")} count="$13" tooltip={25}/>
  <InventorySlot uid="5" sprite={useBaseUrl("/img/Generic5.png")} tooltip={25}/>
  <InventorySlot uid="6" sprite={useBaseUrl("/img/Generic6.png")}/>
</InventoryRow>
```

<BrowserWindow>
<InventoryRow interactive={true} group="useSelectorDemo" maxChoices={4}>
  <InventorySlot uid="1" sprite={useBaseUrl("/img/Generic.png")}/>
  <InventorySlot uid="2" sprite={useBaseUrl("/img/Generic2.png")} count={25}/>
  <InventorySlot uid="3" sprite={useBaseUrl("/img/Generic3.png")} count={25} tooltip="$13"/>
  <InventorySlot uid="4" sprite={useBaseUrl("/img/Generic4.png")} count="$13" tooltip={25}/>
  <InventorySlot uid="5" sprite={useBaseUrl("/img/Generic5.png")} tooltip={25}/>
  <InventorySlot uid="6" sprite={useBaseUrl("/img/Generic6.png")}/>
</InventoryRow>
</BrowserWindow>

:::tip Pro-tip: Local Storage
See the stored data in **Developer Tools > Application > Storage > Local Storage**.
:::

You can also use `group` to synchronize choices between different instances of components:

```jsx
<InventoryRow interactive={true} group="useSelectorDemo2" maxChoices={2}>
  <InventorySlot uid="1" sprite={useBaseUrl("/img/Generic.png")}/>
  <InventorySlot uid="2" sprite={useBaseUrl("/img/Generic2.png")} count={25}/>
  <InventorySlot uid="3" sprite={useBaseUrl("/img/Generic3.png")} count={25} tooltip="$13"/>
  <InventorySlot uid="4" sprite={useBaseUrl("/img/Generic4.png")} count="$13" tooltip={25}/>
  <InventorySlot type={null}/>
  <InventorySlot type={null}/>
</InventoryRow>
<InventoryRow interactive={true} group="useSelectorDemo2" maxChoices={2}>
  <InventorySlot type={null}/>
  <InventorySlot type={null}/>
  <InventorySlot uid="3" sprite={useBaseUrl("/img/Generic3.png")} count={25} tooltip="$13"/>
  <InventorySlot uid="4" sprite={useBaseUrl("/img/Generic4.png")} count="$13" tooltip={25}/>
  <InventorySlot uid="5" sprite={useBaseUrl("/img/Generic5.png")} tooltip={25}/>
  <InventorySlot uid="6" sprite={useBaseUrl("/img/Generic6.png")}/>
</InventoryRow>
```

<BrowserWindow>
<InventoryRow interactive={true} group="useSelectorDemo2" maxChoices={2}>
  <InventorySlot uid="1" sprite={useBaseUrl("/img/Generic.png")}/>
  <InventorySlot uid="2" sprite={useBaseUrl("/img/Generic2.png")} count={25}/>
  <InventorySlot uid="3" sprite={useBaseUrl("/img/Generic3.png")} count={25} tooltip="$13"/>
  <InventorySlot uid="4" sprite={useBaseUrl("/img/Generic4.png")} count="$13" tooltip={25}/>
  <InventorySlot type={null}/>
  <InventorySlot type={null}/>
</InventoryRow>
<InventoryRow interactive={true} group="useSelectorDemo2" maxChoices={2}>
  <InventorySlot type={null}/>
  <InventorySlot type={null}/>
  <InventorySlot uid="3" sprite={useBaseUrl("/img/Generic3.png")} count={25} tooltip="$13"/>
  <InventorySlot uid="4" sprite={useBaseUrl("/img/Generic4.png")} count="$13" tooltip={25}/>
  <InventorySlot uid="5" sprite={useBaseUrl("/img/Generic5.png")} tooltip={25}/>
  <InventorySlot uid="6" sprite={useBaseUrl("/img/Generic6.png")}/>
</InventoryRow>
</BrowserWindow>

:::note
Note the behavior, when a slot that doesn't exist in one of the rows is selected in another row.
:::

## `onChange` event {#onchange-event}

`onChange` doesn't necessarily mean that the values changed. Just that they **could** be different.
